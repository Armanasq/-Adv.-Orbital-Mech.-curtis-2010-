  function x = kepler_U(dt, ro, vro, a)  %x    - the universal anomaly (km^0.5)  %dt   - time since x = 0 (s)  %ro   - radial position (km) when x = 0  %vro  - radial velocity (km/s) when x = 0  %a    - reciprocal of the semimajor axis (1/km)  %z    - auxiliary variable (z = a*x^2)  %C    - value of Stumpff function C(z)  %S    - value of Stumpff function S(z)  %n    - number of iterations for convergence  %nMax - maximum allowable number of iterations    global mu%% Error tolerance ||  Iterations No. limit    error   = 1.e-12;    nMax    = 99000;    x       = sqrt(mu)*abs(a)*dt;    n       = 0;    ratio   = 1;        while abs(ratio) > error && n <= nMax        n     = n + 1;        C     = stumpC(a*x^2);        S     = stumpS(a*x^2);        F     = ro*vro/sqrt(mu)*x^2*C + (1 - a*ro)*x^3*S + ro*x - sqrt(mu)*dt;        dFdx  = ro*vro/sqrt(mu)*x*(1 - a*x^2*S) + (1 - a*ro)*x^2*C + ro;        ratio = F/dFdx;        x     = x - ratio;    endif n > nMax    fprintf('\n No. iterations of Kepler''s equation = %g', n)    fprintf('\n   F/dFdx                              = %g\n', F/dFdx)end